---
name: Import Report Enhancement + Player Name in Party UI
status: open
created: 2026-02-19T23:14:33Z
updated: 2026-02-19T23:18:18Z
github: https://github.com/Polloinfilzato/dm20-protocol/issues/171
depends_on: []
parallel: true
conflicts_with: [173]
---

# Task: Import Report Enhancement + Player Name in Party UI

## Description

Enhance the D&D Beyond import to return a detailed, structured report (status, mapped/unmapped fields, warnings, suggestions). Add `player_name` as an optional field on characters and display it in the party-mode UI alongside the character name.

## Acceptance Criteria

### Import Report

- [ ] Import returns structured report with status: `success`, `success_with_warnings`, `failed`
- [ ] Report lists all fields successfully imported with counts
- [ ] Report lists missing/unsupported fields with explanations
- [ ] Report lists warnings (homebrew items, unknown classes, etc.)
- [ ] Warnings include actionable context (e.g., "Homebrew feat 'X' imported as custom")
- [ ] Report includes actionable suggestions for missing data
- [ ] Report formatted as readable structured text in MCP tool response

### Player Name

- [ ] `create_character()` accepts optional `player_name` parameter
- [ ] `import_from_dndbeyond()` already supports `player_name` (verify and document)
- [ ] Player name stored in character metadata
- [ ] Party-mode UI displays player name alongside character name
- [ ] `list_characters()` output includes player name

## Technical Details

### Import Report Structure

```python
class ImportReport:
    status: str  # "success", "success_with_warnings", "failed"
    character_name: str
    imported_fields: list[ImportedField]  # field name, value summary
    warnings: list[ImportWarning]  # field, message, suggestion
    not_imported: list[NotImported]  # field, reason
    suggestions: list[str]  # actionable advice
```

### Report Format

Generate a formatted text block:
```
D&D Beyond Import Report — Thorin Ironforge
Status: SUCCESS WITH WARNINGS

Imported (12 fields):
  Identity: name, race, class (Fighter 8)
  Abilities: STR 18, DEX 14, CON 16...
  ...

Warnings (3):
  - Homebrew feat "Iron Will" imported as custom
  ...

Not Imported (2):
  - Character portrait (not supported)
  ...

Suggestions:
  - Load Explorer's Guide for Echo Knight support
```

### Player Name in Party UI

In `src/dm20_protocol/party/static/` player UI:
- Display `player_name` alongside character name header
- Format: "Character Name (Player: Real Name)"

### Files Affected

- `src/dm20_protocol/importers/dndbeyond/mapper.py` — Enhanced result reporting
- `src/dm20_protocol/main.py` — `create_character()` player_name param
- `src/dm20_protocol/party/static/` — Player UI: display player name
- `tests/` — Import report tests, player name tests

## Dependencies

- [ ] No task dependencies
- [ ] Requires existing import infrastructure

## Effort Estimate

- Size: S
- Hours: 3-4
- Parallel: true (can run alongside Tasks 167, 168, 170, 171)

## Definition of Done

- [ ] Code implemented
- [ ] Tests written and passing
- [ ] Import report tested with varied character data
- [ ] Player name visible in party-mode UI
- [ ] CHANGELOG.md updated
