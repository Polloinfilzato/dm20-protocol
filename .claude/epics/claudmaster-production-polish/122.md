---
name: Prompt Tuning and Narrative Quality
status: open
created: 2026-02-15T01:33:47Z
updated: 2026-02-15T01:39:36Z
github: https://github.com/Polloinfilzato/dm20-protocol/issues/122
depends_on: [121]
parallel: true
conflicts_with: []
---

# Task: Prompt Tuning and Narrative Quality

## Description
Calibrate agent prompts for vivid, varied, and consistent narrative output across all model quality profiles (quality/balanced/economy). This includes Narrator prompt refinement for atmospheric descriptions, NPC dialogue differentiation, combat narration variety, and validation that all three model profiles produce acceptable quality output.

## Acceptance Criteria
- [ ] Narrator prompts produce atmospheric, specific descriptions (not generic "you enter a room")
- [ ] NPC dialogue has distinct voices: vocabulary, speech patterns, personality markers per NPC
- [ ] Combat narration varies across rounds (not repetitive "you hit for X damage")
- [ ] Quality profile (Opus) produces rich, detailed output
- [ ] Balanced profile produces good, concise output
- [ ] Economy profile (Haiku) produces acceptable, functional output
- [ ] Prompt changes documented in agent files with rationale

## Technical Details
- Modify prompts in `agents/narrator.py` — system prompts for each narrative_style
- Modify prompts in `agents/arbiter.py` — resolution narration templates
- Update `dm-persona.md` — DM voice guidelines for combat, social, exploration
- NPC differentiation: add personality trait → speech pattern mapping in Narrator prompts
- Combat variety: create a bank of combat description templates keyed by action type + outcome
- Model profile validation: run same scenarios across quality/balanced/economy, compare output
- This task is primarily creative/iterative — requires manual playtesting to evaluate quality

## Dependencies
- [ ] #121 — RAG activation (ModuleKeeper provides context that affects narrative quality)

## Effort Estimate
- Size: M
- Hours: 4-6
- Parallel: true (modifies agent prompts, not shared infrastructure files)

## Definition of Done
- [ ] Narrator prompts refined and tested
- [ ] NPC dialogue differentiation implemented
- [ ] Combat narration variety added
- [ ] Manual playtest on all 3 model profiles
- [ ] Quality deemed acceptable on all profiles
