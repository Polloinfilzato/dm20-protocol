---
name: Specialist Sub-Agents
status: open
created: 2026-02-09T01:33:04Z
updated: 2026-02-09T01:37:45Z
github: https://github.com/Polloinfilzato/dm20-protocol/issues/70
depends_on: [69]
parallel: true
conflicts_with: []
---

# Task: Specialist Sub-Agents

## Description

Create three Claude Code sub-agent files in `.claude/agents/` for specialized DM roles: narrator, combat-handler, and rules-lookup. These agents are spawned by Claude during complex scenarios to parallelize work and provide focused expertise.

Each agent is a markdown file following the same format as the existing `.claude/agents/python-pro.md`.

## Acceptance Criteria

- [ ] `.claude/agents/narrator.md` created — scene descriptions, atmosphere, NPC voices
- [ ] `.claude/agents/combat-handler.md` created — combat management, tactics, resolution
- [ ] `.claude/agents/rules-lookup.md` created — rules queries, spell/monster/class details
- [ ] Each agent specifies which MCP tools it uses
- [ ] Each agent follows the existing agent file format (frontmatter with name, description, tools, model)
- [ ] Agents reference DM persona principles (state before narrative, proactive tool use)
- [ ] Agent instructions are concise and actionable

## Technical Details

### File Format (from existing python-pro.md)
```markdown
---
name: <agent-name>
description: <one-line summary>
tools: <comma-separated tool list>
model: sonnet
---

<detailed instructions>
```

### narrator.md
- **Purpose:** Generate rich scene descriptions, atmospheric text, NPC dialogue
- **Tools:** `get_location`, `get_npc`, `list_npcs`, `get_game_state`, `search_rules`, `get_character`
- **Model:** sonnet (creative tasks benefit from quality, but sonnet is sufficient)
- **Instructions:** Scene-setting principles, sensory detail layering, NPC voice differentiation, tone matching (gothic horror vs heroic fantasy), read-aloud text formatting

### combat-handler.md
- **Purpose:** Manage combat encounters from initiative to aftermath
- **Tools:** `start_combat`, `next_turn`, `end_combat`, `roll_dice`, `update_character`, `bulk_update_characters`, `get_character`, `get_monster_info`, `get_spell_info`, `add_event`
- **Model:** sonnet
- **Instructions:** Initiative rolling, turn sequence, attack resolution (to-hit → damage → apply), enemy tactics by archetype, death saves, combat narration, aftermath (XP, loot)

### rules-lookup.md
- **Purpose:** Quick rules reference, spell details, monster stat blocks, class features
- **Tools:** `search_rules`, `get_spell_info`, `get_monster_info`, `get_class_info`, `get_race_info`, `validate_character_rules`
- **Model:** haiku (fast lookups, no creativity needed)
- **Instructions:** How to interpret search results, when to cite specific rules, how to present stat blocks, how to handle rules conflicts

## Dependencies
- [ ] Task 69 (DM Persona File) — agents must align with persona principles

## Effort Estimate
- Size: S
- Hours: 2-3
- Parallel: true (can run alongside Task 71)
- Conflicts: none

## Definition of Done
- [ ] 3 agent files created in `.claude/agents/`
- [ ] Each agent has correct frontmatter format
- [ ] Tool lists are accurate (tools actually exist)
- [ ] Instructions are concise and actionable
