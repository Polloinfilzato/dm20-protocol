---
name: Claudmaster Configuration MCP Tool
status: completed
created: 2026-02-05T19:06:45Z
updated: 2026-02-07T01:07:41Z
github: https://github.com/Polloinfilzato/dm20-protocol/issues/33
depends_on: [33, 34]
parallel: false
conflicts_with: []
---

# Claudmaster Configuration MCP Tool

## Description

Implement the `configure_claudmaster` MCP tool that allows users to configure and manage Claudmaster AI DM settings for their campaigns. This tool provides the interface between the MCP client and the Claudmaster configuration system, enabling persistent storage and retrieval of settings.

## Acceptance Criteria

- [ ] Implement `configure_claudmaster` MCP tool function
- [ ] Store ClaudmasterConfig per campaign (persistent)
- [ ] Load existing configuration on campaign load
- [ ] Validate all configuration options
- [ ] Provide sensible default configuration values
- [ ] Support partial updates (update only specified fields)
- [ ] Return current configuration after changes
- [ ] Add to MCP tool registry
- [ ] Create unit tests for all operations
- [ ] Document tool usage and options

## Technical Details

### MCP Tool Definition

```python
@mcp_tool(
    name="configure_claudmaster",
    description="Configure the Claudmaster AI DM settings for the current campaign."
)
async def configure_claudmaster(
    # LLM Settings
    llm_model: str | None = None,
    temperature: float | None = None,

    # Narrative Settings
    narrative_style: Literal["descriptive", "terse", "dramatic", "mysterious"] | None = None,
    detail_level: Literal["low", "medium", "high"] | None = None,

    # Game Settings
    difficulty: Literal["easy", "normal", "hard", "deadly"] | None = None,
    rules_strictness: Literal["loose", "standard", "strict"] | None = None,

    # Feature Toggles
    auto_combat: bool | None = None,
    auto_loot: bool | None = None,

    # Action
    reset_to_defaults: bool = False,
) -> str:
    """Configure Claudmaster AI DM settings."""
    pass
```

### Default Configuration

```python
DEFAULT_CONFIG = ClaudmasterConfig(
    llm_model="claude-sonnet-4-20250514",
    temperature=0.7,
    narrative_style="descriptive",
    detail_level="medium",
    difficulty="normal",
    rules_strictness="standard",
    auto_combat=False,
    auto_loot=False,
)
```

### Storage Integration

- Store config in campaign data directory
- Use JSON serialization for ClaudmasterConfig
- Load automatically when campaign is loaded
- Create default config if none exists

### Validation Rules

- `temperature`: 0.0 to 1.0
- `llm_model`: Must be valid Claude model ID
- Enum fields: Must match allowed values
- Boolean fields: Must be true/false

### Return Format

```
Claudmaster Configuration Updated:

LLM Settings:
  Model: claude-sonnet-4-20250514
  Temperature: 0.7

Narrative Settings:
  Style: descriptive
  Detail Level: medium

Game Settings:
  Difficulty: normal
  Rules Strictness: standard

Feature Toggles:
  Auto Combat: disabled
  Auto Loot: disabled
```

## Dependencies

- Task #32: Claudmaster Directory Structure and Base Classes
  - Requires ClaudmasterConfig dataclass
- Task #33: Orchestrator Skeleton
  - Configuration must integrate with Orchestrator initialization

## Effort Estimate

- **Size:** S
- **Estimated Hours:** 4
- **Complexity:** Low - straightforward CRUD with validation

## Definition of Done

1. MCP tool registered and callable
2. Configuration stored persistently per campaign
3. All validation rules implemented
4. Default values working correctly
5. Partial updates supported
6. Configuration loads on campaign load
7. Clear formatted output
8. Unit tests passing
9. Tool documented in project docs
10. Code reviewed and approved
