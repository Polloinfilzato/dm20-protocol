---
name: Add python-toon dependency and TOON encoder
status: open
created: 2026-02-01T23:51:23Z
updated: 2026-02-01T23:51:23Z
github: https://github.com/Polloinfilzato/gamemaster-mcp/issues/5
updated: 2026-02-02T00:06:07Z
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Add python-toon dependency and TOON encoder

## Description

Add python-toon as a project dependency and create a utility wrapper for encoding data to TOON format with graceful fallback to JSON.

## Acceptance Criteria

- [ ] Add `python-toon >= 0.1.0` to `pyproject.toml` dependencies
- [ ] Create `toon_encoder.py` utility module
- [ ] Implement `encode_to_toon(data: Any) -> str` function
- [ ] Implement graceful fallback to JSON if TOON encoding fails
- [ ] Handle TOON import errors gracefully (library not installed)
- [ ] Document TOON format benefits in code comments

## Technical Details

**New file:** `src/gamemaster_mcp/toon_encoder.py`

```python
from typing import Any
import json

try:
    import toon
    TOON_AVAILABLE = True
except ImportError:
    TOON_AVAILABLE = False

def encode_to_toon(data: Any, fallback_to_json: bool = True) -> str:
    """Encode data to TOON format with JSON fallback."""
    if TOON_AVAILABLE:
        try:
            return toon.dumps(data)
        except Exception:
            if fallback_to_json:
                return json.dumps(data)
            raise
    elif fallback_to_json:
        return json.dumps(data)
    else:
        raise ImportError("python-toon not installed")
```

**Files affected:**
- `pyproject.toml`
- `src/gamemaster_mcp/toon_encoder.py` (new)

## Dependencies

- [ ] None (independent task)

## Effort Estimate

- Size: S
- Hours: 2-3
- Parallel: true

## Definition of Done

- [ ] Dependency added
- [ ] Encoder utility created
- [ ] Fallback mechanism tested
- [ ] Unit tests passing
